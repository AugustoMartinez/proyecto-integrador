import{a as F,b as z}from"./chunk-RUSIH3UO.js";import{a as V}from"./chunk-OO3WAGFG.js";import{b as B}from"./chunk-UMWSO6KU.js";import"./chunk-LJ5XHLMQ.js";import{g as E,h as M,j as O}from"./chunk-H3MYTDDY.js";import{$a as j,Ba as C,Fa as h,K as I,La as p,Ma as b,P as k,Sa as r,Ta as s,Ua as y,Va as _,W as g,Wa as S,X as v,Xa as m,Ya as a,Za as A,_a as x,ab as T,n as w,qa as P,sa as n,xa as u}from"./chunk-WRNNQS3D.js";import{h as d}from"./chunk-FK42CRUA.js";var l=class i{constructor(t){this.http=t}apiUrl="https://pokeapi.co/api/v2/pokemon/";getPokemon(t){return d(this,null,function*(){return w(this.http.get(`${this.apiUrl}${t}`))})}getRandomPokemonId(){return Math.floor(Math.random()*151)+1}static \u0275fac=function(e){return new(e||i)(k(F))};static \u0275prov=I({token:i,factory:i.\u0275fac})};function Q(i,t){if(i&1){let e=_();r(0,"button",7),S("click",function(){let c=g(e).$implicit,f=m(2);return v(f.checkAnswer(c))}),a(1),s()}if(i&2){let e=t.$implicit,o=m(2);p("disabled",o.showAnswer),n(),x(" ",e," ")}}function U(i,t){if(i&1){let e=_();r(0,"div")(1,"p"),a(2),s(),r(3,"button",8),S("click",function(){g(e);let c=m(2);return v(c.loadQuestion())}),a(4,"Siguiente"),s()()}if(i&2){let e=m(2);n(2),A(e.isCorrect?"\xA1Correcto!":"Incorrecto...")}}function $(i,t){if(i&1&&(r(0,"div",1)(1,"h1"),a(2,"\xBFQui\xE9n es ese Pok\xE9mon?"),s(),y(3,"img",2),r(4,"div",3),h(5,Q,2,2,"button",4),s(),h(6,U,5,1,"div",5),r(7,"div",6)(8,"p"),a(9),s(),r(10,"p"),a(11),s()()()),i&2){let e=m();n(3),b("filter",e.showAnswer?"none":"brightness(0)"),p("src",e.pokemonImage,P),n(2),p("ngForOf",e.options),n(),p("ngIf",e.showAnswer),n(3),j("Puntos: ",e.score," | R\xE9cord: ",e.bestScore,""),n(2),x("Tiempo restante: ",e.timer,"s")}}var R=class i{constructor(t,e,o){this.pokemonService=t;this._authService=e;this._puntajeService=o}pokemonImage="";correctAnswer="";options=[];showAnswer=!1;isCorrect=!1;score=0;bestScore=0;timer=10;timerInterval;ngOnInit(){this.loadBestScore(),this.loadQuestion()}ngOnDestroy(){this.clearTimer()}loadQuestion(){return d(this,null,function*(){this.showAnswer=!1,this.options=[],this.timer=10,this.clearTimer(),this.startTimer();let t=this.pokemonService.getRandomPokemonId(),e=yield this.pokemonService.getPokemon(t);this.correctAnswer=e.name,this.pokemonImage=e.sprites.other["official-artwork"].front_default;let o=new Set([t]);for(;o.size<4;)o.add(this.pokemonService.getRandomPokemonId());let c=[];for(let f of o){let N=yield this.pokemonService.getPokemon(f);c.push(N.name)}this.options=this.shuffleArray(c)})}checkAnswer(t){this.showAnswer||(this.showAnswer=!0,this.clearTimer(),this.isCorrect=t===this.correctAnswer,this.isCorrect?(this.score++,this.updateBestScore(),this.guardarPuntaje()):this.score=0)}startTimer(){this.timerInterval=setInterval(()=>{this.timer--,this.timer===0&&(this.showAnswer=!0,this.clearTimer(),this.isCorrect=!1,this.score=0)},1e3)}clearTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)}shuffleArray(t){return t.sort(()=>Math.random()-.5)}loadBestScore(){let t=localStorage.getItem("pokemonBestScore");this.bestScore=t?parseInt(t,10):0}updateBestScore(){this.score>this.bestScore&&(this.bestScore=this.score,localStorage.setItem("pokemonBestScore",this.bestScore.toString()))}guardarPuntaje(){return d(this,null,function*(){let t=yield this._authService.getUserId(),e=yield this._puntajeService.saveResult(t,"pokemon",this.score);e?console.error("Error al guardar en Supabase:",e):console.log("Resultado guardado")})}static \u0275fac=function(e){return new(e||i)(u(l),u(B),u(V))};static \u0275cmp=C({type:i,selectors:[["app-preguntados"]],features:[T([l])],decls:1,vars:1,consts:[["class","quiz-container",4,"ngIf"],[1,"quiz-container"],["alt","Pok\xE9mon",1,"pokemon-img",3,"src"],[1,"options"],[3,"disabled","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"stats"],[3,"click","disabled"],[3,"click"]],template:function(e,o){e&1&&h(0,$,12,8,"div",0),e&2&&p("ngIf",o.pokemonImage)},dependencies:[O,E,M,z],styles:[".quiz-container[_ngcontent-%COMP%]{text-align:center;padding:20px}.pokemon-img[_ngcontent-%COMP%]{width:200px;image-rendering:pixelated}.options[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-wrap:wrap;justify-content:center;gap:10px}.stats[_ngcontent-%COMP%]{margin-top:20px;font-size:16px}button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px}"]})};export{R as PreguntadosComponent};
